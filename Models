install.packages("caret")
library(caret)
library(doParallel)

#GLM
glm.null = glm(Default ~ 0, data = fullDf, family = binomial)
glm.full = glm(Default~., data = fullDf, family = binomial)

glm.step = step(glm.null, scope = list(lower=glm.null,upper=glm.full),
     direction="both")




rfControl = trainControl(method = "repeatedcv",
                         number = 10,
                         repeats = 2)

rfGrid <-  expand.grid( 
  mtry  = c(2:8)
)
cl <- makeCluster(detectCores()-1)
registerDoParallel(cl)

rf.fit = caret::train(Default ~ ., data = fullDf, 
                      method = 'rf', 
                      trControl = rfControl,
                      tuneGrid = rfGrid)
stopCluster(cl)
registerDoSEQ()


rf.fit <- randomForest(Default ~., data = fullDf,ntree = 100)


